{% extends 'MarkLoginBundle::menu.html.twig' %}
{% block title %}{{ title }}{% endblock %}

{# set delete modal properties #}
{% set modal_delete_id = "menuDeleteModal" %}
{% set modal_delete_route = "menu_delete" %}
{% use "MarkGeneralBundle:Default:deleteModal.html.twig" with javascripts as js_delete_modal, modal as html_delete_modal %}

{# set sortable jQueryUI properties #}
{% set sortable_container = "tbody" %}
{% set sortable_key = "srt" %}
{% set sortable_route = "menu_rowsort" %}
{% use "MarkGeneralBundle:jQueryUIActions:sortableRows.js.twig" with javascripts as sortable_rows %}

{# set image modal properties #}
{% set modal_image_id = "modalImageId" %}
{% use "MarkGeneralBundle:Default:fileModal.html.twig" with modal as html_image_modal %}

{% block body %}
	<div class="container-fluid">
		<div class="row">
			<div class="panel panel-default">
				<div class="panel-heading">
					<h4>
						{{ 'Manage menu sections'|trans }} |
						<a href="" data-toggle="modal" data-target="#{{ modal_image_id }}" data-route = "{{ path('menu_change_picture') }}">{{ 'Change menu image'|trans }}</a>
						<a href="" class="addaction pull-right">
							<i title="{{ 'Add'|trans }}" class="glyphicon glyphicon-plus"></i>{{ 'Add'|trans }}
						</a>
					</h4>
				</div>
			<div id="manage-menu" class="panel-body">
				<table class="table table-hover table-condensed">
					<thead>
						<tr>
							{% for col in menu_columns %}
								<th class="alert-info">
									<a href="{{ path('menu_colsort', {'param': 'm_sortcol', 'value': col}) }}">{{ col|upper }}</a>
								</th>
							{% endfor %}
							<th class="alert-info"></th>
						</tr>
					</thead>
					<tbody>
							{% for row in menu_rows %}
								<tr id="{{ sortable_key ~ "_" ~ row.id }}">
									{% for key,cel in row %}
										<td>
											{% if "roles" == key %}
												{% if cel == 0 %}
													USER
												{% elseif cel == 1 %}
													ADMIN
												{% elseif cel == 2 %}
													SUPER ADMIN
												{% endif %}
											{% elseif "sort" == key %}
													<i class="glyphicon glyphicon-move"></i>
											{% elseif "isActive" == key %}
													<input type="checkbox"
													   {{ (1 == cel) ? 'checked' : 'unchecked' }}
													   data-toggle="toggle"
													   data-size="mini"
													   data-on="{{ 'On'|trans }}"
													   data-off="{{ 'Off'|trans }}"
													   data-onstyle="success"
													   data-offstyle="danger">
											{% else %}
											    {{ cel }}
											{% endif %}
										</td>
									{% endfor %}
									<td>
										<a class="deleteaction" title="{{ 'Delete'|trans }}" data-toggle="modal" data-target="#{{ modal_delete_id }}" data-row-id={{ row.id }}>
											<i class="glyphicon glyphicon-remove"></i>
										</a>
									</td>
								</tr>
							{% endfor %}
						</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

{{ block('html_delete_modal') }}
{{ block('html_image_modal') }}
{% endblock %}

{% block javascripts %}
	<script type="text/javascript">
		{{ block('sortable_rows') }}
		{{ block('js_delete_modal') }}
	</script>
{% endblock %}